<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.71.1"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=/proloaf/favicons/favicon.ico><link rel=apple-touch-icon href=/proloaf/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/proloaf/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/proloaf/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/proloaf/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/proloaf/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/proloaf/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/proloaf/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/proloaf/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/proloaf/favicons/android-192x192.png sizes=192x192><title>train.py | Probabilistic Load Forecasting</title><meta name=description content="Documentation for the ProLoaF Project"><meta property="og:title" content="train.py"><meta property="og:description" content="Basic information on the training script."><meta property="og:type" content="article"><meta property="og:url" content="https://sogno.github.io/proloaf/docs/files-and-scripts/fc_train/"><meta property="article:published_time" content="2020-03-09T00:00:00+00:00"><meta property="article:modified_time" content="2022-04-02T14:28:48+02:00"><meta property="og:site_name" content="Probabilistic Load Forecasting"><meta itemprop=name content="train.py"><meta itemprop=description content="Basic information on the training script."><meta itemprop=datePublished content="2020-03-09T00:00:00+00:00"><meta itemprop=dateModified content="2022-04-02T14:28:48+02:00"><meta itemprop=wordCount content="666"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="train.py"><meta name=twitter:description content="Basic information on the training script."><link rel=preload href=/proloaf/scss/main.min.94ce11f58d187a35be31a6377e251f63f40502f8243aed7bab5db5425c428b6e.css as=style><link href=/proloaf/scss/main.min.94ce11f58d187a35be31a6377e251f63f40502f8243aed7bab5db5425c428b6e.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/proloaf/><span class=navbar-logo></span><span class="text-uppercase font-weight-bold">Probabilistic Load Forecasting</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/proloaf/about/><span>About</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/proloaf/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/proloaf/community/><span>Community</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-proloafdocs-li><a href=/proloaf/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-proloafdocs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-proloafdocsoverview-li><a href=/proloaf/docs/overview/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-proloafdocsoverview><span>Overview</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-proloafdocsgetting-started-li><a href=/proloaf/docs/getting-started/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-proloafdocsgetting-started><span>Getting Started</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-proloafdocsfiles-and-scripts-li><a href=/proloaf/docs/files-and-scripts/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-proloafdocsfiles-and-scripts><span>Files and Scripts</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-proloafdocsfiles-and-scriptsfc_prep-li><a href=/proloaf/docs/files-and-scripts/fc_prep/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-proloafdocsfiles-and-scriptsfc_prep><span>preprocess.py</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-proloafdocsfiles-and-scriptsfc_train-li><a href=/proloaf/docs/files-and-scripts/fc_train/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-proloafdocsfiles-and-scriptsfc_train><span class=td-sidebar-nav-active-item>train.py</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-proloafdocsfiles-and-scriptsinterpreter-li><a href=/proloaf/docs/files-and-scripts/interpreter/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-proloafdocsfiles-and-scriptsinterpreter><span>interpreter.py</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-proloafdocsfiles-and-scriptsfc_evaluate-li><a href=/proloaf/docs/files-and-scripts/fc_evaluate/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-proloafdocsfiles-and-scriptsfc_evaluate><span>evaluate.py</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-proloafdocsfiles-and-scriptsconfig-li><a href=/proloaf/docs/files-and-scripts/config/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-proloafdocsfiles-and-scriptsconfig><span>config.json</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-proloafdocsfiles-and-scriptsbaselines-li><a href=/proloaf/docs/files-and-scripts/baselines/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-proloafdocsfiles-and-scriptsbaselines><span>baselines.py</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-proloafdocscontribution-guidelines-li><a href=/proloaf/docs/contribution-guidelines/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-proloafdocscontribution-guidelines><span>Contribution Guidelines</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-proloafdocstutorials-li><a href=/proloaf/docs/tutorials/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-proloafdocstutorials><span>Tutorials</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-proloafdocsreference-li><a href=/proloaf/docs/reference/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-proloafdocsreference><span>Reference</span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/google/docsy-example/edit/master/content/en/docs/Files%20and%20Scripts/fc_train.md target=_blank><i class="fa fa-edit fa-fw"></i>Edit this page</a>
<a href="https://github.com/google/docsy-example/new/master/content/en/docs/Files%20and%20Scripts/fc_train.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i>Create child page</a>
<a href="https://github.com/google/docsy-example/issues/new?title=train.py" target=_blank><i class="fab fa-github fa-fw"></i>Create documentation issue</a>
<a href=https://github.com/google/docsy/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i>Create project issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><ul><li><a href=#overview>Overview</a></li><li><a href=#hyperparameter-exploration>Hyperparameter Exploration</a></li><li><a href=#json-config-files>.json Config Files</a></li><li><a href=#inputs>Inputs</a></li><li><a href=#outputs>Outputs</a></li><li><a href=#reference-documentation>Reference Documentation</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://sogno.github.io/proloaf/docs/>Documentation</a></li><li class=breadcrumb-item><a href=https://sogno.github.io/proloaf/docs/files-and-scripts/>Files and Scripts</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://sogno.github.io/proloaf/docs/files-and-scripts/fc_train/>train.py</a></li></ol></nav><div class=td-content><h1>train.py</h1><div class=lead>Basic information on the training script.</div><header class=article-meta></header><h3 id=overview>Overview</h3><p>This script trains an RNN model on previously prepared data, which is loaded into a pandas Dataframe from a csv file.
Hyperparameter exploration using optuna is also possible if desired. The trained model is saved at the location
specified under <code>"output_path":</code> in the corresponding config.json and can be loaded via torch.load() or evaluated by
using the evaluate.py script. This script scales the data, loads a custom data structure and then generates and
trains a neural net.</p><h3 id=hyperparameter-exploration>Hyperparameter Exploration</h3><p>Any training parameter is considered a hyper parameter as long as it is specified in either <em>config.json</em> or
<em>tuning.json</em>. The latter is the standard file where the (so far) best found configuration is saved and should usually
not be manually adapted unless new tests are for some reason not comparable to older ones (e.g. after changing the loss
function).</p><h3 id=json-config-files>.json Config Files</h3><h4 id=configjson><em>config.json</em></h4><p>The config should define parameters that are not considered hyperparameters. Anything considered a hyperparameter (see above) may be defined but will be overwritten in training. These are many parameters not listed here, the structure is evident from the config however. The not so obvious parameters are:</p><ol><li>&ldquo;feature_groups&rdquo; (list) of dicts each specifying:<ol><li>&ldquo;name&rdquo;: (str) name of the group for identification</li><li>&ldquo;scaler&rdquo;: (list or null) with [0] the name of a scaler, [1] and [2] the arguments for its creation, or null for unscaled features</li><li>&ldquo;features&rdquo;: (list) feature names that should be scaled by the corresponding scaler, no double listing supported.
A feature that is not listed in any feature group is not considered by the net.</li></ol></li><li>&ldquo;encoder/decoder_features&rdquo;: (list) features that are visible to the encoder/decoder.</li></ol><h4 id=tuningjson><em>tuning.json</em></h4><p>Here all settings considering hyperparameter exploration can be adjusted. Any hyper parameter that is to be explored should be defined here in the &ldquo;settings&rdquo; dict (example below). In addition to settings dict there are two settings:</p><ol><li>&ldquo;rel_base_path&rdquo;: (str or null) relative path to the base config w.r.t. the project folder. If the file does not exist, it will be created at the end to save the best performing setup. If the file exists, the base setup will be trained first to be compared with the others (or to train the net with the most performant parameters).</li><li>&ldquo;number_of_tests&rdquo;: (int optional) number of nets that are trained and compared, defaults to 1 if not specified. This number includes the base setup if one is defined.</li><li>&ldquo;settings&rdquo; (dict of dicts): defines parameters as keys of this dict e.g. &ldquo;learning_rate&rdquo; could be a key of the settings dict and its value is either:<ol><li>A value, the parameter is set to this value for all iterations. If the value itself is supposed to be a list, it has to be a list inside a list otherwise it will be interpreted as list of values.</li><li>A list of values, the list is cycled over for each test.</li><li>A dict defining:<ol><li>&ldquo;function&rdquo;: (str) a string defining the import to a function, e.g &lsquo;random.gauss&rsquo; will import the function &lsquo;gauss&rsquo; from the &lsquo;random&rsquo; module. This function will be called multiple times if necessary to generate values. If the function generates a list, each value will be used exactly once before generating new values, making random.choices() a candidate to prevent too much repetition. This should work with custom functions, but this has not been tested.</li><li>&ldquo;kwargs&rdquo;: (dict) a dict containing all necessary arguments to call the function.</li></ol></li></ol></li></ol><p><em>Example:</em></p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#000;font-weight:700>{</span>
  <span style=color:#204a87;font-weight:700>&#34;number_of_tests&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>100</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#204a87;font-weight:700>&#34;settings&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
      <span style=color:#204a87;font-weight:700>&#34;learning_rate&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
          <span style=color:#204a87;font-weight:700>&#34;function&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;suggest_loguniform&#34;</span><span style=color:#000;font-weight:700>,</span>
          <span style=color:#204a87;font-weight:700>&#34;kwargs&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
              <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;learning_rate&#34;</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#204a87;font-weight:700>&#34;low&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>0.000001</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#204a87;font-weight:700>&#34;high&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>0.0001</span>
          <span style=color:#000;font-weight:700>}</span>
      <span style=color:#000;font-weight:700>},</span>
      <span style=color:#204a87;font-weight:700>&#34;history_horizon&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
          <span style=color:#204a87;font-weight:700>&#34;function&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;suggest_int&#34;</span><span style=color:#000;font-weight:700>,</span>
          <span style=color:#204a87;font-weight:700>&#34;kwargs&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
              <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;history_horizon&#34;</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#204a87;font-weight:700>&#34;low&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#204a87;font-weight:700>&#34;high&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>168</span>
          <span style=color:#000;font-weight:700>}</span>
      <span style=color:#000;font-weight:700>},</span>
      <span style=color:#204a87;font-weight:700>&#34;batch_size&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
          <span style=color:#204a87;font-weight:700>&#34;function&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;suggest_int&#34;</span><span style=color:#000;font-weight:700>,</span>
          <span style=color:#204a87;font-weight:700>&#34;kwargs&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
              <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;batch_size&#34;</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#204a87;font-weight:700>&#34;low&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>32</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#204a87;font-weight:700>&#34;high&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>120</span>
          <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000;font-weight:700>}</span>
  <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><p>Possible hyperparameters are:</p><p>target_column, encoder_features, decoder_features, max_epochs, learning_rate, batch_size,
shuffle, history_horizon, forecast_horizon,
train_split, validation_split, core_net,
relu_leak, dropout_fc, dropout_core,
rel_linear_hidden_size, rel_core_hidden_size,
optimizer_name, cuda_id</p><h3 id=inputs>Inputs</h3><p>One of the following:</p><ul><li>./data/opsd.csv</li><li>./data/&#171;user_provided_data&#187;.csv</li><li>./data/gefcom2017/&#171;station&#187;_data.csv (data not available as of March 2022, but present in earlier versions</li></ul><h3 id=outputs>Outputs</h3><ul><li>./oracles/model_station</li></ul><h3 id=reference-documentation>Reference Documentation</h3><p>If you need more details, please take a look at the <a href=https://sogno.github.io/proloaf/reference/proloaf/proloaf/src/train.html>docs</a> for
this script.</p><div class="text-muted mt-5 pt-3 border-top">Last modified
April 2, 2022
: <a href=https://github.com/google/docsy-example/commit/0f90685246f0b36a778983d1d3d42272cf6105e8>update links in docs (0f90685)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitLab aria-label=GitLab><a class=text-white target=_blank rel=noopener href=https://git.rwth-aachen.de/acs/public/automation/plf/proloaf aria-label=GitLab><i class="fab fa-gitlab"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel=noopener href=https://feinev.slack.com/ aria-label=Slack><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Developer mailing list" aria-label="Developer mailing list"><a class=text-white target=_blank rel=noopener href=mailto:gguerses@eonerc.rwth-aachen.de aria-label="Developer mailing list"><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 E.ON Energy Research Center All Rights Reserved</small>
<small class=ml-1><a href=https://policies.google.com/privacy target=_blank rel=noopener>Privacy Policy</a></small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script><script src=/proloaf/js/main.min.58cf026c413bcc8d9ac51cae3c9f98a6983c4ad449b431137fc299a5e843e833.js integrity="sha256-WM8CbEE7zI2axRyuPJ+Yppg8StRJtDETf8KZpehD6DM=" crossorigin=anonymous></script></body></html>